{"version":3,"file":"annotator-view.global.js","sources":["../../annotator-core/src/enums/elements.ts","../../annotator-text/src/index.ts","../src/index.ts"],"sourcesContent":["export enum HTML_NODE_ENUMS {\n    SPAN = 'SPAN',\n    BR = 'br',\n    DIV = 'div'\n}","import {HTML_NODE_ENUMS} from '@molar/annotator-core'\n\nclass Text{\n    readonly textContent:string;\n    readonly parentNode:HTMLElement;\n    readonly needsBR: boolean\n    readonly className: string\n    readonly isLabeled: boolean\n    public currentNode : HTMLElement|null\n    constructor(parentNode:HTMLElement,textContent:string,needsBR:boolean = false,className:string,isLabeled:boolean){\n        this.currentNode = null\n        this.parentNode = parentNode;\n        this.isLabeled = isLabeled\n        this.textContent = textContent\n        this.className = className\n        this.needsBR = needsBR\n        this.generateTextNode()\n        // generator BR\n        // const brNode = document.createElement(HTML_NODE_ENUMS.BR)\n        // this.parentNode.appendChild(brNode)\n    }\n    private generateTextNode(){\n        const divNode = document.createElement(HTML_NODE_ENUMS.DIV)\n        const spanNode = document.createElement(HTML_NODE_ENUMS.SPAN)\n        spanNode.className = this.className\n        spanNode.innerText = this.textContent\n        this.currentNode = divNode\n        this.currentNode.style.display = \"inline\"\n        this.currentNode.appendChild(spanNode)\n        if(this.needsBR){\n            console.log(this.needsBR)\n            const brNode = document.createElement(HTML_NODE_ENUMS.BR)\n            this.currentNode.appendChild(brNode)\n        }\n        this.parentNode.appendChild(divNode)\n    }\n    public addChildNodeToText(parentNode:HTMLElement,textContent:string,className:string){\n        const textNode = document.createElement(HTML_NODE_ENUMS.SPAN)\n        textNode.innerText = textContent\n        textNode.className = className\n        parentNode.appendChild(textNode)\n    }\n}\n\nexport {Text}","import {Core} from '@molar/annotator-core'\nimport {Text} from '@molar/annotator-text'\n\nexport type TextNode = {\n    text: Text,\n    _molar_text_id: number\n}\n\nclass View {\n    readonly root:Core\n    readonly textNodeList:TextNode[]\n    constructor(root:Core){\n        this.root = root\n        this.textNodeList = []\n        this.generatorTextNode()\n        this.registerViewEventHandler()\n    }\n    private generatorTextNode(){\n        console.log(\"view generator\")\n        const parentNode = this.root.element\n        const spanTextArr = this.root.data.split(this.root.splitRegExp)\n        for(let i=0;i<spanTextArr.length;i++){\n            const textNode = new Text(parentNode,spanTextArr[i],true,\"\",false)\n            this.textNodeList.push({\n                text: textNode,\n                _molar_text_id: i\n            })\n        }\n    }\n    private registerViewEventHandler(){\n        this.root.element.onmouseup = function(e){\n            this.root.textSelectionHandler.textSelection(e)\n        }.bind(this)\n    }\n    private renderViewByTextNodeList(textNodeList: TextNode[]){\n        console.log(textNodeList)\n        // remove all text\n        for(let i=0;i<this.root.element.children.length;i++){\n            this.root.element.removeChild(this.root.element.children[i])\n        }\n        for(const item of textNodeList){\n            this.root.element.appendChild(item.text.currentNode)\n        }\n    }\n    public UpdateTextNodeListIndex(insertArr:TextNode[],id:number){\n        this.textNodeList.splice(id,1,...insertArr)\n        for(let i=0;i<this.textNodeList.length;i++){\n            this.textNodeList[i]._molar_text_id = i\n        }\n        this.renderViewByTextNodeList(this.textNodeList)\n    }\n    \n}\nexport {View}"],"names":[],"mappings":"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"}